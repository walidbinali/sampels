sample and simple Dll injector with CreateRemoteThread() API function , it works very well on XP , but on windows 7 you should search about the reason , why it maybe fail ?

have fun with creating your dll file ;)

